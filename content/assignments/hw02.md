---
title: "New Models + Module CRUD"
type: "homework"
num: "2"
draft: 0
assigned_date: "2026-01-29"
due_date: "2026-02-05"
heading_max_level: 3
---

> ## Overview
>
> This assignment has three parts:
> 1. **Domain modeling + schema design** - draw and explain your proposed backend data model
> 2. **Implement Module CRUD endpoints** - implement and test contract-level behavior for the Module resource
> 3. **Peer review + individual reflection** - review a teammate’s PR and reflect on design + implementation
>
> This assignment builds on HW1's contract-level testing approach and introduces domain modeling and relationship design.

## Before You Begin: Team Task Assignment Tips

1. Start by co-designing the data model together
2. Consider assigning roles by responsibility, not files (adjust this approach to fit your team's needs):
    - **Schema lead** (models & relationships)
    - **API lead** (endpoint behavior & contracts)
    - **Test lead** (edge cases & failure modes)
    - **Integrator** (keeps work aligned, ensures pieces fit together)
3. Split implementation by layer (models / schemas / routes / tests), not by feature
4. Pair on complex parts (e.g., thinking about relationships and authentication)
5. Set a mid-point check: "Does our code still match the diagram?"
6. No merges without tests passing and one teammate review

## 1. Domain Model Design

Before writing code, you will design the core learning-content data model for the app.

> ### Application Requirements
> 
> You are building a health-focused learning app that helps parents learn skills through structured content:
> 
> - Parents register and are assigned to one or more **Courses** they must complete.
> - Each **Course** consists of roughly 10 **Modules**.
> - A **Module** may belong to **more than one course**.
> - A **Module** is composed of an ordered sequence of **Posts**.
> - **Posts** can have multiple types: `video`, `attachment`, `quiz`, `default`.
> - User progress is tracked across the **Course** to which they are assigned.

### 1.1 Deliverable: Model drawing + notes
Create a diagram of your proposed models and relationships.

**Your diagram must include:**
- Entities (tables/models) you propose
- Relationships (one-to-many, many-to-many, etc.)
- Key attributes (fields) for each entity, including data types and which attributes are mandatory vs optional
- Primary keys and foreign keys (at a conceptual level)

**Format:**
- Hand-drawn (photo) OR digital (draw.io / Excalidraw / Figma / etc.)
- Save it as `hw02_model_design.pdf` or `hw02_model_design.png`

**Submission:**
- Add the file to your PR (in a `/docs` folder) OR include it in your PR description (linked image).
- Include ~200–400 words explaining key design decisions:
  - How you represented **module reuse across courses**
  - Any parts that were more tricky than others and why you ultimately made the decisions you did.

There is more than one valid solution. The goal is to make tradeoffs explicit.


## 2. Implement Module CRUD

In this part, you will implement **only the Module resource** end-to-end:
- SQLAlchemy model(s) as needed
- Pydantic schemas
- Routes (CRUD endpoints)
- Contract-level API tests

You are **not** implementing full course assignment logic, post creation, or progress tracking yet — but your design should anticipate them.

### 2.1. Required endpoints (Module resource)
Implement the following endpoints in `backend/routes/modules.py`:

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/modules` | GET | List modules accessible to the user |
| `/api/modules/{id}` | GET | Get a single module |
| `/api/modules` | POST | Create a new module |
| `/api/modules/{id}` | PATCH | Update a module |
| `/api/modules/{id}` | DELETE | Delete a module |

**Assumptions (unless your starter code dictates otherwise):**
- You must require authentication for all module endpoints.
- You should enforce role-based behavior if the existing app uses roles (e.g., only admins/managers can create/delete).
- Modules should have at minimum:
  - `id`
  - `title`
  - `description` (optional)
  - any fields already implied by the starter code

### 2.2. Write behavior contracts (required)
For **each endpoint**, write a behavior contract (as in HW1). Include:

- **Input:** params + request body
- **Behavior:** step-by-step what happens
- **Output:** status code + response shape
- **Errors:** common failure cases (401/403/404/422/400)

**Submission:**
Include behavior contracts **in your PR description** OR in a file: `docs/hw02_contracts.md`.

### 2.3. Implement data model changes (as needed)
You will likely need new/updated models to support future work. At minimum, implement what your Module endpoints needs right now.

**Design requirements you should plan for (but may implement partially):**
- A module can belong to multiple courses (many-to-many)
- A module contains ordered posts (ordering must be representable)

You are not required to build all endpoints for those relationships yet, but your schema should not block future work.

### 2.4. Write tests (contract-level)
Create `tests/test_modules.py` and write contract-level tests for each endpoint.

Minimum coverage per endpoint:
1. **Success case** (200/201/204 etc.)
2. **At least 2 failure cases**, such as:
   - missing/invalid input → 422
   - unauthorized → 401
   - forbidden (wrong role) → 403
   - not found → 404
   - business rule violation (if applicable) → 400

**Testing constraints:**
- Prefer verifying behavior through the API (not direct DB queries)
- Use existing fixtures (`client`, `test_db`, `auth_headers`, etc.)
- Tests should be clear, independent, and fast
- Use `@pytest.mark.asyncio` if your test suite is async (match the existing pattern)

## 3. Pull Requests, Review, and Reflection

Teams may organize their work using one or more pull requests. This is expected and encouraged.

### 3.1 Pull Requests and Review

All work for HW2 must be submitted via pull requests and **merged into `main` by the deadline**.

By the deadline:
- All relevant PRs should be **reviewed and approved**
- All changes should be **merged into `main`**
- The repository should reflect the team’s final, integrated solution

We will review:
- **All PRs** created for HW2
- The quality and substance of code reviews
- Evidence of collaboration and iteration

There is no required number of PRs. Teams should choose a workflow that supports clear design, clean implementation, and shared ownership.


### 3.2 Model Diagram + Team Design Reflection

The team must submit:
- A shared **ER/model diagram** representing the proposed backend design
- A short **team reflection** (200–400 words) explaining:
  - Key modeling decisions
  - How relationships and ordering were handled
  - Tradeoffs made and alternatives considered

This may be included in a PR description or in a file in the repository (e.g., `docs/hw02_design.md`).


### 3.3 Individual Reflection

Each student must complete an individual reflection in their shared Google document (`LastName_FirstName_373`).

Under today’s date, respond (200–350 words total):

1. What design decision felt most important in this assignment, and why?
2. What was hardest about implementing Module CRUD cleanly?
3. What did you learn from reviewing teammates’ work?

Paste your reflection into the Weekly Reflection Form as usual.


## Submission Checklist

**Design**
- [ ] Team ER/model diagram included in the repository or PRs
- [ ] Team design reflection (200–400 words)

**Implementation**
- [ ] Module CRUD endpoints implemented (`GET list`, `GET one`, `POST`, `PATCH`, `DELETE`)
- [ ] Module schemas created and used correctly
- [ ] Authentication and role-based behavior enforced (per starter code expectations)
- [ ] Contract-level tests written for all Module endpoints
- [ ] Each endpoint includes at least one success test and at least two failure tests

**Process**
- [ ] All HW2-related work submitted via PRs
- [ ] All PRs reviewed and approved
- [ ] All HW2 changes merged into `main` by the deadline
- [ ] Individual reflection completed and submitted

